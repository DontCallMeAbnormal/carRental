<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
 <mapper namespace="cn.tongRenCollege.dao.mapper.UserMapper">
 
 <!-- 增加 -->
 	<insert id="creatOrder" parameterType="Order" >
 		INSERT INTO `order` (`order_id`, `order_vehicle_id`, `order_user_id`, `order_price`, `order_state`, `order_startDate`, `order_quantity`) 
 		VALUES (#{order_id}, #{order_vehicle_id}, #{order_user_id}, #{order_price}, '预订单', #{order_startDate}, #{order_quantity});
 	</insert>
 	
 	
 	
 <!-- /增加 -->
 
 
 <!-- 删除 -->
 	<delete id="deleteOrder" parameterType="String">
 		DELETE FROM `order` WHERE (`order_id`=#{arg0} and `order_user_id`=#{arg1});
 	</delete>
 
 
 <!-- /删除 -->
 
 <!-- 修改 -->
 	<update id="updataOrder" parameterType="Order" >
		UPDATE `order`
			<trim prefix="set" suffixOverrides=",">
                <if test="order_vehicle_id != null">order_vehicle_id=#{order_vehicle_id},</if>
                <if test="order_price != null and order_price > 0">order_price=#{order_price},</if>
                <if test="order_startDate != null">order_startDate=#{order_startDate},</if>
				<if test="order_quantity != null and order_quantity > 0">order_quantity=#{order_quantity},</if>
            </trim>
		WHERE (`order_id`= #{order_id} and `order_user_id` = #{order_user_id});
	</update>
 
 
 <!-- /修改 -->
 
 
 <!-- 查询 -->
 
 	<!-- 订单 -->
 	<select id="queryOrderHistory" parameterType="String" resultType="Order">
 		SELECT * FROM `order` WHERE `order_user_id`=#{user_id};
 	</select>
 	<select id="queryOrderByorder" parameterType="Order" resultType="Order">
 		SELECT * FROM `order`
 		<where>
 			`order_user_id`=#{order_user_id}
 			<if test="order_id != null ">
 				and order_id = #{order_id}
 			</if>
 			<if test="order_vehicle_id != null">
 				and order_vehicle_id = #{order_vehicle_id}
 			</if>
 			<if test="order_price != null and order_price > 0">
 				and order_price = #{order_price}
 			</if>
 			<if test="order_state != null ">
 				and order_state = #{order_state}
 			</if>
 			<if test="order_startDate != null ">
 				and order_startDate = #{order_startDate}
 			</if>
 		</where>
 	</select>
 
 	<!-- 用户 -->
 	<select id="getUser" parameterType="User" resultType="User">
 		SELECT * FROM `user` WHERE (user_id=#{user_id} and user_pwd=#{user_pwd}) 
 		OR (user_phone=#{user_phone} and user_pwd=#{user_pwd});
 	</select>
 
 
 	<!-- 车辆 -->
 	
	<select id="queryVehicleFullAll" parameterType="String" resultMap="VehicleFull">
			<include refid="cn.tongRenCollege.dao.mapper.AdmMapper.queryVehicleFullAllSql"/>
	</select>
	<resultMap type="VehicleFull" id="VehicleFull">
			<id column="vehicle_id" property="vehicle_id"/>
			<result	column="vehicle_base_id" property="vehicle_base_id"/>
			<result	column="vehicle_employee_id" property="vehicle_employee_id"/>
			<result	column="vehicle_price" property="vehicle_price"/>
			<result	column="vehicle_describe" property="vehicle_describe"/>
			<result	column="vehicle_mileage" property="vehicle_mileage"/>
			<result	column="vehicle_condition" property="vehicle_condition"/>
			<result	column="vehicle_state" property="vehicle_state"/>
			<association property="base" javaType="Base">
				<id column="base_id" property="base_id" />
				<result	column="base_photo" property="base_photo"/>
				<result	column="base_type" property="base_type"/>
				<result	column="base_brand" property="base_brand"/>
				<result	column="base_model" property="base_model"/>
				<result	column="base_produced" property="base_produced"/>
				<result	column="base_displacement" property="base_displacement"/>
				<result	column="base_speed" property="base_speed"/>
			</association>
		</resultMap>
 <!-- /查询 -->
 
 </mapper>